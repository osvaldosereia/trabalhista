<!DOCTYPE html>
<html lang="pt-BR">
<meta charset="utf-8">
<title>Gerador de Prompt – Trabalhista</title>
<style>
body{font-family:system-ui;margin:20px;background:#f4f4f4;color:#111}
h1{font-size:18px}
#lista button{margin:3px 0}
textarea{width:100%;height:200px;margin-top:10px}
#blocos{margin-top:10px;background:#fff;padding:10px;border-radius:8px}
#final{margin-top:20px}
</style>
<h1>Gerador de Prompt – Peça Trabalhista</h1>

<p><b>Instrução geral (fixa):</b></p>
<textarea id="instrucao" readonly>
Você é ADVOGADO ESPECIALISTA EM DIREITO DO TRABALHO no Brasil.
Sua função é REDIGIR uma PEÇA PROCESSUAL COMPLETA com base nos DADOS e DOCUMENTOS anexados,
seguindo os padrões forenses, a legislação e a jurisprudência atual.
Todos os blocos abaixo representam partes integradas da mesma petição.
</textarea>

<h3>Blocos disponíveis</h3>
<div id="lista">Carregando...</div>

<h3>Prompt Final</h3>
<textarea id="final" placeholder="Clique nos blocos para montar o prompt..."></textarea>
<br>
<button onclick="copiar()">Copiar Prompt</button>

<script>
async function carregar() {
  try {
    const txt = await fetch("data/blocos-trabalhistas.txt").then(r => r.text());
    const blocosBrutos = txt.split("=== BLOCO:").slice(1);
    const blocos = blocosBrutos.map(b => {
      const primeiraLinha = b.split("\n")[0].trim(); // ex: "fatos|Fatos – Contrato..."
      const partes = primeiraLinha.split("|");
      const id = partes[0]?.trim() || "sem_id";
      const titulo = partes[1]?.trim() || "Sem título";
      const texto = b.split("///")[0].split("\n").slice(1).join("\n").trim();
      return { id, titulo, texto };
    });

    const lista = document.getElementById("lista");
    lista.innerHTML = "";
    blocos.forEach(b => {
      const bt = document.createElement("button");
      bt.textContent = b.titulo;
      bt.style.display = "block";
      bt.style.margin = "4px 0";
      bt.onclick = () => adicionar(b);
      lista.appendChild(bt);
    });
  } catch (e) {
    console.error(e);
    document.getElementById("lista").innerHTML = "Erro ao carregar blocos.";
  }
}

function adicionar(b) {
  const final = document.getElementById("final");
  final.value += `\n\n[${b.titulo}]\n${b.texto}`;
}

function copiar() {
  const instrucao = document.getElementById("instrucao").value;
  const final = document.getElementById("final").value;
  navigator.clipboard.writeText(instrucao + "\n\n" + final);
  alert("Prompt copiado!");
}

carregar();
</script>

</html>
